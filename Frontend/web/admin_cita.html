<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Citas</title>
    <link rel="stylesheet" href="/barberia/Frontend/css/admin_cita.css">
</head>
<body>
    <header>
        <h1>Administrar Citas</h1>
    </header>
    
    <main>
        <article class="admin-form">
            <h2>Seleccionar Disponibilidad</h2>

            <label for="dia">Día:</label>
            <select id="dia" name="dia" aria-label="Seleccionar día">
                <option value="" disabled selected>--Seleccionar día--</option>
                <option value="Lunes">Lunes</option>
                <option value="Martes">Martes</option>
                <option value="Miércoles">Miércoles</option>
                <option value="Jueves">Jueves</option>
                <option value="Viernes">Viernes</option>
                <option value="Sábado">Sábado</option>
                <option value="Domingo">Domingo</option>
            </select>

            <label for="hora">Hora:</label>
            <select id="hora" name="hora" aria-label="Seleccionar hora">
                <option value="" disabled selected>--Seleccionar hora--</option>
                <option value="09:00">09:00</option>
                <option value="10:00">10:00</option>
                <option value="11:00">11:00</option>
                <option value="12:00">12:00</option>
                <option value="13:00">13:00</option>
                <option value="14:00">14:00</option>
                <option value="15:00">15:00</option>
                <option value="16:00">16:00</option>
                <option value="17:00">17:00</option>
            </select>

            <button id="guardar" onclick="guardarDisponibilidad()">Guardar Disponibilidad</button>
            <div id="mensaje" class="mensaje"></div> <!-- Mensaje de confirmación -->
        </article>

        <article class="citas-registradas">
            <h2>Citas Registradas</h2>
            <table id="tablaCitas">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Correo</th>
                        <th>Día</th>
                        <th>Hora</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Las citas se agregarán aquí -->
                </tbody>
                
            </table>
            
        </article>
        <button class="button" onclick="window.location.href='/barberia/Frontend/web/inicio.html'">Regresar</button>
    </main>

    <footer>
        <p>&copy; 2024 Barbería. Todos los derechos reservados.</p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Cargar citas registradas (puedes hacer esto desde una base de datos)
            cargarCitasRegistradas();
        });
        
        function guardarDisponibilidad() {
            const dia = document.getElementById("dia").value;
            const hora = document.getElementById("hora").value;
            const mensajeDiv = document.getElementById("mensaje");

            if (!dia || !hora) {
                mensajeDiv.textContent = "Por favor, selecciona un día y una hora.";
                mensajeDiv.style.color = "red"; // Mensaje de error en rojo
                return;
            }

            // Enviar datos al servidor usando AJAX
            fetch('guardar_disponibilidad.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ dia: dia, hora: hora })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    mensajeDiv.textContent = "Disponibilidad guardada correctamente.";
                    mensajeDiv.style.color = "green"; // Mensaje de éxito en verde
                    // Actualizar la tabla de citas registradas
                    agregarCitaATabla("Nombre Ejemplo", "correo@ejemplo.com", dia, hora);
                } else {
                    mensajeDiv.textContent = "Error al guardar la disponibilidad.";
                    mensajeDiv.style.color = "red"; // Mensaje de error en rojo
                }
            })
            .catch(error => {
                console.error('Error:', error);
                mensajeDiv.textContent = "Error al guardar la disponibilidad.";
                mensajeDiv.style.color = "red"; // Mensaje de error en rojo
            });
        }

        function agregarCitaATabla(nombre, correo, dia, hora) {
            const tabla = document.querySelector("#tablaCitas tbody");
            const fila = document.createElement("tr");
            fila.innerHTML = `
                <td>${nombre}</td>
                <td>${correo}</td>
                <td>${dia}</td>
                <td>${hora}</td>
                <td><button onclick="eliminarCita(this)">Eliminar</button></td>
            `;
            tabla.appendChild(fila);
        }

        function eliminarCita(boton) {
            const fila = boton.parentElement.parentElement;
            fila.remove();
        }

        function cargarCitasRegistradas() {
            // Lógica para cargar citas desde la base de datos
        }
    </script>
</body>
</html>
